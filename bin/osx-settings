#!/usr/bin/env bash

########################################################################################
# General UI                                                                           #
########################################################################################

# Dark interface
defaults write NSGlobalDomain AppleInterfaceStyle -string "Dark"

########################################################################################
# Menu                                                                                 #
########################################################################################

# Show battery percentage
defaults write com.apple.menuextra.battery ShowPercent -string "YES"

# Show date in clock
defaults write com.apple.menuextra.clock DateFormat -string "EEE d MMM  HH:mm"

########################################################################################
# HDD                                                                                  #
########################################################################################

# Disable hibernation (speeds up entering sleep mode)
sudo pmset -a hibernatemode 0

########################################################################################
# Trackpad                                                                             #
########################################################################################

# Disable auto-correct
defaults write NSGlobalDomain NSAutomaticSpellingCorrectionEnabled -bool false

# Scroll direction unnatural
defaults write NSGlobalDomain com.apple.swipescrolldirection -bool false

# Trackpad speed fast
defaults write NSGlobalDomain com.apple.trackpad.scaling -float 2.5

########################################################################################
# Screen                                                                               #
########################################################################################

# Require password immediately after sleep or screen saver begins
defaults write com.apple.screensaver askForPassword -int 1
defaults write com.apple.screensaver askForPasswordDelay -int 0

# Enable subpixel font rendering on non-Apple LCDs
defaults write NSGlobalDomain AppleFontSmoothing -int 2

########################################################################################
# Dock                                                                                 #
########################################################################################

# Autohide dock
defaults write com.apple.dock autohide -bool "true"

# # Left positioned
defaults write com.apple.dock orientation -string "left"

# Icons size
defaults write com.apple.dock tilesize -integer 36

########################################################################################
# Finder                                                                               #
########################################################################################

# Create Workspace
mkdir -p Workspace/nass600

# Show icons for hard drives, servers, and removable media on the desktop
defaults write com.apple.finder ShowExternalHardDrivesOnDesktop -bool true
defaults write com.apple.finder ShowHardDrivesOnDesktop -bool true
defaults write com.apple.finder ShowRemovableMediaOnDesktop -bool true

# Finder: show all filename extensions
defaults write NSGlobalDomain AppleShowAllExtensions -bool true

# Finder: show status bar
defaults write com.apple.finder ShowStatusBar -bool true

# Display full POSIX path as Finder window title
defaults write com.apple.finder _FXShowPosixPathInTitle -bool true

# When performing a search, search the current folder by default
defaults write com.apple.finder FXDefaultSearchScope -string "SCcf"

# Disable the warning when changing a file extension
defaults write com.apple.finder FXEnableExtensionChangeWarning -bool false

# Avoid creating .DS_Store files on network volumes
defaults write com.apple.desktopservices DSDontWriteNetworkStores -bool true

# Enable snap-to-grid for icons on the desktop and in other icon views
/usr/libexec/PlistBuddy -c "Set :DesktopViewSettings:IconViewSettings:arrangeBy name" ~/Library/Preferences/com.apple.finder.plist
/usr/libexec/PlistBuddy -c "Set :FK_StandardViewSettings:IconViewSettings:arrangeBy name" ~/Library/Preferences/com.apple.finder.plist
/usr/libexec/PlistBuddy -c "Set :StandardViewSettings:IconViewSettings:arrangeBy name" ~/Library/Preferences/com.apple.finder.plist
defaults write com.apple.finder FXArrangeGroupViewBy -string "Name"

# Use icon view in all Finder windows by default
# Four-letter codes for the other view modes: `icnv`, `Nlsv`, `clmv`, `Flwv`
defaults write com.apple.finder FXPreferredViewStyle -string "icnv"

########################################################################################
# Users                                                                                #
########################################################################################

sudo defaults write com.apple.loginwindow GuestEnabled -bool NO

########################################################################################
# Kill/restart affected applications                                                   #
########################################################################################

# Restart affected applications if `--no-restart` flag is not present.
if [[ ! ($* == *--no-restart*) ]]; then
  for app in "cfprefsd" "Dock" "Finder" "SystemUIServer"; do
    killall "${app}"
  done
fi